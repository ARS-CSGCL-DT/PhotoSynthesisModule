<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>A Biochemical Simulation Model of Photosynthesis and Transpiration: photomod::CGasExchange Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Stomate.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A Biochemical Simulation Model of Photosynthesis and Transpiration
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">C++ code that can be incorporated into modes to simulate photosynthesis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacephotomod.html">photomod</a></li><li class="navelem"><a class="el" href="classphotomod_1_1_c_gas_exchange.html">CGasExchange</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classphotomod_1_1_c_gas_exchange-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">photomod::CGasExchange Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class for gas exchange calculations<br />
This class simulates gas exchange in plant leaves for C3 and C4 plants.  
 <a href="classphotomod_1_1_c_gas_exchange.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html">tParms</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">parameter description  <a href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a050cd969516229a8c9e81d3f4fbd8c93"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a050cd969516229a8c9e81d3f4fbd8c93">CGasExchange</a> ()</td></tr>
<tr class="memdesc:a050cd969516229a8c9e81d3f4fbd8c93"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the constructor.  <a href="#a050cd969516229a8c9e81d3f4fbd8c93">More...</a><br /></td></tr>
<tr class="separator:a050cd969516229a8c9e81d3f4fbd8c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53029130b9501a86771ce1b3dc617a81"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a53029130b9501a86771ce1b3dc617a81">~CGasExchange</a> (void)</td></tr>
<tr class="memdesc:a53029130b9501a86771ce1b3dc617a81"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the destructor.  <a href="#a53029130b9501a86771ce1b3dc617a81">More...</a><br /></td></tr>
<tr class="separator:a53029130b9501a86771ce1b3dc617a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfe13266ecb7ed5533da29252967108"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a7dfe13266ecb7ed5533da29252967108">get_ANet</a> ()</td></tr>
<tr class="memdesc:a7dfe13266ecb7ed5533da29252967108"><td class="mdescLeft">&#160;</td><td class="mdescRight">return net photosynthesis (umol CO2 m-2 s-1)  <a href="#a7dfe13266ecb7ed5533da29252967108">More...</a><br /></td></tr>
<tr class="separator:a7dfe13266ecb7ed5533da29252967108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5f8c05c2f447fd2fa5d96a150cb435"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ada5f8c05c2f447fd2fa5d96a150cb435">get_AGross</a> ()</td></tr>
<tr class="memdesc:ada5f8c05c2f447fd2fa5d96a150cb435"><td class="mdescLeft">&#160;</td><td class="mdescRight">return gross photosynthesis (umol CO2 m-2 s-1)  <a href="#ada5f8c05c2f447fd2fa5d96a150cb435">More...</a><br /></td></tr>
<tr class="separator:ada5f8c05c2f447fd2fa5d96a150cb435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c222492610a8b385af08b963a81bdac"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a8c222492610a8b385af08b963a81bdac">get_Transpiration</a> ()</td></tr>
<tr class="memdesc:a8c222492610a8b385af08b963a81bdac"><td class="mdescLeft">&#160;</td><td class="mdescRight">return transpiration rate (umol H2O m-2 s-1)  <a href="#a8c222492610a8b385af08b963a81bdac">More...</a><br /></td></tr>
<tr class="separator:a8c222492610a8b385af08b963a81bdac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5392cd5c6850f36e8d259259b2270c1a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a5392cd5c6850f36e8d259259b2270c1a">get_LeafTemperature</a> ()</td></tr>
<tr class="memdesc:a5392cd5c6850f36e8d259259b2270c1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">return leaf temperature (C)  <a href="#a5392cd5c6850f36e8d259259b2270c1a">More...</a><br /></td></tr>
<tr class="separator:a5392cd5c6850f36e8d259259b2270c1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a05d6ae02f21fc9123620cf60e198e7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a6a05d6ae02f21fc9123620cf60e198e7">get_Ci</a> ()</td></tr>
<tr class="memdesc:a6a05d6ae02f21fc9123620cf60e198e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">return internal CO2 concentration (umol mol-1)  <a href="#a6a05d6ae02f21fc9123620cf60e198e7">More...</a><br /></td></tr>
<tr class="separator:a6a05d6ae02f21fc9123620cf60e198e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd59e3c69511501eb1a3ad050a112b14"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#afd59e3c69511501eb1a3ad050a112b14">get_StomatalConductance</a> ()</td></tr>
<tr class="memdesc:afd59e3c69511501eb1a3ad050a112b14"><td class="mdescLeft">&#160;</td><td class="mdescRight">return stomatal conductance to water vapor (mol m-2 s-1)  <a href="#afd59e3c69511501eb1a3ad050a112b14">More...</a><br /></td></tr>
<tr class="separator:afd59e3c69511501eb1a3ad050a112b14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24df2395552c74860d753500c20a9c92"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a24df2395552c74860d753500c20a9c92">get_BoundaryLayerConductance</a> ()</td></tr>
<tr class="memdesc:a24df2395552c74860d753500c20a9c92"><td class="mdescLeft">&#160;</td><td class="mdescRight">return boundary layer conductance (mol m-2 s-1)  <a href="#a24df2395552c74860d753500c20a9c92">More...</a><br /></td></tr>
<tr class="separator:a24df2395552c74860d753500c20a9c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a261b64980edd972c9a095a7b765f2917"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a261b64980edd972c9a095a7b765f2917">get_Respiration</a> ()</td></tr>
<tr class="memdesc:a261b64980edd972c9a095a7b765f2917"><td class="mdescLeft">&#160;</td><td class="mdescRight">return respiration rate (umol CO2 m-2 s-1)  <a href="#a261b64980edd972c9a095a7b765f2917">More...</a><br /></td></tr>
<tr class="separator:a261b64980edd972c9a095a7b765f2917"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade28cd8421d71ad5db0054dc94500412"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ade28cd8421d71ad5db0054dc94500412">get_VPD</a> ()</td></tr>
<tr class="memdesc:ade28cd8421d71ad5db0054dc94500412"><td class="mdescLeft">&#160;</td><td class="mdescRight">return vapor pressure deficit (kpa)  <a href="#ade28cd8421d71ad5db0054dc94500412">More...</a><br /></td></tr>
<tr class="separator:ade28cd8421d71ad5db0054dc94500412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa270acbbeb85882ff4f8f5fff92da5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a8fa270acbbeb85882ff4f8f5fff92da5">SetParams</a> (<a class="el" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html">tParms</a> *<a class="el" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4">sParms</a>)</td></tr>
<tr class="memdesc:a8fa270acbbeb85882ff4f8f5fff92da5"><td class="mdescLeft">&#160;</td><td class="mdescRight">used to pass structure with parameters from the interface to the calculator  <a href="#a8fa270acbbeb85882ff4f8f5fff92da5">More...</a><br /></td></tr>
<tr class="separator:a8fa270acbbeb85882ff4f8f5fff92da5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85daf4befe81254dd962d4cd497cb1a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a85daf4befe81254dd962d4cd497cb1a8">SetVal</a> (double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#aabd821405fe6b92ccdacbeeaa582198b">PhotoFluxDensity</a>, double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332">Tair</a>, double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2">CO2</a>, double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#a58f7d4d251727e692ac8fbad2fb57956">RH</a>, double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#ae45cf7c89cde073d1aa2eece25727388">wind</a>, double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda">Press</a>, bool ConstantTemperature)</td></tr>
<tr class="memdesc:a85daf4befe81254dd962d4cd497cb1a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets input values for calculations for a particular set of environmental variables  <a href="#a85daf4befe81254dd962d4cd497cb1a8">More...</a><br /></td></tr>
<tr class="separator:a85daf4befe81254dd962d4cd497cb1a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ae2941a2ddaff5c03c5d5ef97f9ffabb4"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html">photomod::CGasExchange::tParms</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4">sParms</a></td></tr>
<tr class="memdesc:ae2941a2ddaff5c03c5d5ef97f9ffabb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable of type <a class="el" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html" title="parameter description ">tParms</a>.  <a href="#ae2941a2ddaff5c03c5d5ef97f9ffabb4">More...</a><br /></td></tr>
<tr class="separator:ae2941a2ddaff5c03c5d5ef97f9ffabb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:adc6695b31b7fc63f6b6e4941a102f9c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#adc6695b31b7fc63f6b6e4941a102f9c4">GasEx</a> ()</td></tr>
<tr class="memdesc:adc6695b31b7fc63f6b6e4941a102f9c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main module to calculate gas exchange rates.  <a href="#adc6695b31b7fc63f6b6e4941a102f9c4">More...</a><br /></td></tr>
<tr class="separator:adc6695b31b7fc63f6b6e4941a102f9c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0489552d5fb0005cc46e70942bdbba5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a0489552d5fb0005cc46e70942bdbba5f">PhotosynthesisC3</a> (double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7">Ci</a>)</td></tr>
<tr class="memdesc:a0489552d5fb0005cc46e70942bdbba5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate C3 photosynthesis.  <a href="#a0489552d5fb0005cc46e70942bdbba5f">More...</a><br /></td></tr>
<tr class="separator:a0489552d5fb0005cc46e70942bdbba5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5c21e41dfb582c06f14f7fb26d708f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ac5c21e41dfb582c06f14f7fb26d708f1">PhotosynthesisC4</a> (double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7">Ci</a>)</td></tr>
<tr class="memdesc:ac5c21e41dfb582c06f14f7fb26d708f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate C4 photosynthesis.  <a href="#ac5c21e41dfb582c06f14f7fb26d708f1">More...</a><br /></td></tr>
<tr class="separator:ac5c21e41dfb582c06f14f7fb26d708f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c0002b03cb9847bad2467fb12692a40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a2c0002b03cb9847bad2467fb12692a40">EnergyBalance</a> ()</td></tr>
<tr class="memdesc:a2c0002b03cb9847bad2467fb12692a40"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates leaf temperature and transpiration  <a href="#a2c0002b03cb9847bad2467fb12692a40">More...</a><br /></td></tr>
<tr class="separator:a2c0002b03cb9847bad2467fb12692a40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a337206050da05fc358a540556d2caff1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a337206050da05fc358a540556d2caff1">SearchCi</a> (double CO2i)</td></tr>
<tr class="memdesc:a337206050da05fc358a540556d2caff1"><td class="mdescLeft">&#160;</td><td class="mdescRight">called iterively to find optimal internal CO2 concentration returns optimal internal CO2 concentration (CO2i)  <a href="#a337206050da05fc358a540556d2caff1">More...</a><br /></td></tr>
<tr class="separator:a337206050da05fc358a540556d2caff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dc539abc744407ed843a3ea8c77af11"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11">EvalCi</a> (double <a class="el" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7">Ci</a>)</td></tr>
<tr class="memdesc:a4dc539abc744407ed843a3ea8c77af11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci and new Ci.  <a href="#a4dc539abc744407ed843a3ea8c77af11">More...</a><br /></td></tr>
<tr class="separator:a4dc539abc744407ed843a3ea8c77af11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84f459cce51fbef9289fa51e646d82db"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a84f459cce51fbef9289fa51e646d82db">CalcStomatalConductance</a> ()</td></tr>
<tr class="memdesc:a84f459cce51fbef9289fa51e646d82db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stomatal conductance (mol m-2 s-1)  <a href="#a84f459cce51fbef9289fa51e646d82db">More...</a><br /></td></tr>
<tr class="separator:a84f459cce51fbef9289fa51e646d82db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b9eba78c508968ed95404a1cdaa4a7f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a6b9eba78c508968ed95404a1cdaa4a7f">CalcTurbulentVaporConductance</a> ()</td></tr>
<tr class="memdesc:a6b9eba78c508968ed95404a1cdaa4a7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conductance for turbulant vapor transfer in air - forced convection (mol m-2 s-1)  <a href="#a6b9eba78c508968ed95404a1cdaa4a7f">More...</a><br /></td></tr>
<tr class="separator:a6b9eba78c508968ed95404a1cdaa4a7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32e40db907f72c57d9ec546dee8fa75d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d">Es</a> (double Temperature)</td></tr>
<tr class="memdesc:a32e40db907f72c57d9ec546dee8fa75d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saturated vapor pressure at given temperature.  <a href="#a32e40db907f72c57d9ec546dee8fa75d">More...</a><br /></td></tr>
<tr class="separator:a32e40db907f72c57d9ec546dee8fa75d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450c0f7a9613bad31be095c88c9e9121"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a450c0f7a9613bad31be095c88c9e9121">Slope</a> (double Temperature)</td></tr>
<tr class="memdesc:a450c0f7a9613bad31be095c88c9e9121"><td class="mdescLeft">&#160;</td><td class="mdescRight">Slope of the vapor pressure curve.  <a href="#a450c0f7a9613bad31be095c88c9e9121">More...</a><br /></td></tr>
<tr class="separator:a450c0f7a9613bad31be095c88c9e9121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60529d982d8ff5172e3f8f26ad752c60"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a60529d982d8ff5172e3f8f26ad752c60">QuadSolnUpper</a> (double a, double b, double c)</td></tr>
<tr class="memdesc:a60529d982d8ff5172e3f8f26ad752c60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upper part of quadratic equation solution.  <a href="#a60529d982d8ff5172e3f8f26ad752c60">More...</a><br /></td></tr>
<tr class="separator:a60529d982d8ff5172e3f8f26ad752c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d206e8ffab6c56c2fb66cc3c02ab827"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a4d206e8ffab6c56c2fb66cc3c02ab827">QuadSolnLower</a> (double a, double b, double c)</td></tr>
<tr class="memdesc:a4d206e8ffab6c56c2fb66cc3c02ab827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lower part of quadratic equation solution.  <a href="#a4d206e8ffab6c56c2fb66cc3c02ab827">More...</a><br /></td></tr>
<tr class="separator:a4d206e8ffab6c56c2fb66cc3c02ab827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad23c00de704b06ad8e6835e6b1fd4b60"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ad23c00de704b06ad8e6835e6b1fd4b60">minh</a> (double fn1, double fn2, double theta2)</td></tr>
<tr class="memdesc:ad23c00de704b06ad8e6835e6b1fd4b60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hyperbolic minimum.  <a href="#ad23c00de704b06ad8e6835e6b1fd4b60">More...</a><br /></td></tr>
<tr class="separator:ad23c00de704b06ad8e6835e6b1fd4b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a9bdc0eb2e7bb7b716186f96436fa17"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a9a9bdc0eb2e7bb7b716186f96436fa17">get_CiCaRatio</a> ()</td></tr>
<tr class="memdesc:a9a9bdc0eb2e7bb7b716186f96436fa17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ratio between internal and atmospheric CO2.  <a href="#a9a9bdc0eb2e7bb7b716186f96436fa17">More...</a><br /></td></tr>
<tr class="separator:a9a9bdc0eb2e7bb7b716186f96436fa17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaf6c1a776c7562827048da056b07d97"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#aaaf6c1a776c7562827048da056b07d97">Square</a> (double a)</td></tr>
<tr class="memdesc:aaaf6c1a776c7562827048da056b07d97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Squares number.  <a href="#aaaf6c1a776c7562827048da056b07d97">More...</a><br /></td></tr>
<tr class="separator:aaaf6c1a776c7562827048da056b07d97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10a6134ecf2bb59a4a719ece9573d32"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#aa10a6134ecf2bb59a4a719ece9573d32">Min</a> (double a, double b, double c)</td></tr>
<tr class="memdesc:aa10a6134ecf2bb59a4a719ece9573d32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds minimum of three numbers.  <a href="#aa10a6134ecf2bb59a4a719ece9573d32">More...</a><br /></td></tr>
<tr class="separator:aa10a6134ecf2bb59a4a719ece9573d32"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aabd821405fe6b92ccdacbeeaa582198b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#aabd821405fe6b92ccdacbeeaa582198b">PhotoFluxDensity</a></td></tr>
<tr class="memdesc:aabd821405fe6b92ccdacbeeaa582198b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Photosynthetic Flux Density (umol photons m-2 s-1.  <a href="#aabd821405fe6b92ccdacbeeaa582198b">More...</a><br /></td></tr>
<tr class="separator:aabd821405fe6b92ccdacbeeaa582198b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf96c972db93276390570b52e2f4efa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#acaf96c972db93276390570b52e2f4efa">R_abs</a></td></tr>
<tr class="memdesc:acaf96c972db93276390570b52e2f4efa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Absorbed incident radiation (watts m-2)  <a href="#acaf96c972db93276390570b52e2f4efa">More...</a><br /></td></tr>
<tr class="separator:acaf96c972db93276390570b52e2f4efa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3e1c02f9ce0d34ea3795046bfec332"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332">Tair</a></td></tr>
<tr class="memdesc:acd3e1c02f9ce0d34ea3795046bfec332"><td class="mdescLeft">&#160;</td><td class="mdescRight">Air temperature at 2m, (C)  <a href="#acd3e1c02f9ce0d34ea3795046bfec332">More...</a><br /></td></tr>
<tr class="separator:acd3e1c02f9ce0d34ea3795046bfec332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa69249f07aa4e7350dfdc8bc068f9ac2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2">CO2</a></td></tr>
<tr class="memdesc:aa69249f07aa4e7350dfdc8bc068f9ac2"><td class="mdescLeft">&#160;</td><td class="mdescRight">CO2 concentration (umol mol-1 air)  <a href="#aa69249f07aa4e7350dfdc8bc068f9ac2">More...</a><br /></td></tr>
<tr class="separator:aa69249f07aa4e7350dfdc8bc068f9ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58f7d4d251727e692ac8fbad2fb57956"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a58f7d4d251727e692ac8fbad2fb57956">RH</a></td></tr>
<tr class="memdesc:a58f7d4d251727e692ac8fbad2fb57956"><td class="mdescLeft">&#160;</td><td class="mdescRight">Relative Humidity (%, i.e., 80)  <a href="#a58f7d4d251727e692ac8fbad2fb57956">More...</a><br /></td></tr>
<tr class="separator:a58f7d4d251727e692ac8fbad2fb57956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45cf7c89cde073d1aa2eece25727388"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ae45cf7c89cde073d1aa2eece25727388">wind</a></td></tr>
<tr class="memdesc:ae45cf7c89cde073d1aa2eece25727388"><td class="mdescLeft">&#160;</td><td class="mdescRight">Windspeed at 2 meters (km s-1)  <a href="#ae45cf7c89cde073d1aa2eece25727388">More...</a><br /></td></tr>
<tr class="separator:ae45cf7c89cde073d1aa2eece25727388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0196427149bf76a9d50e51bf46392dd7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a0196427149bf76a9d50e51bf46392dd7">width</a></td></tr>
<tr class="memdesc:a0196427149bf76a9d50e51bf46392dd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Leaf width (m)  <a href="#a0196427149bf76a9d50e51bf46392dd7">More...</a><br /></td></tr>
<tr class="separator:a0196427149bf76a9d50e51bf46392dd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c65b0756348471b5a5883ec284dbda"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda">Press</a></td></tr>
<tr class="memdesc:ab1c65b0756348471b5a5883ec284dbda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Air pressure (kPa)  <a href="#ab1c65b0756348471b5a5883ec284dbda">More...</a><br /></td></tr>
<tr class="separator:ab1c65b0756348471b5a5883ec284dbda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a865730e6305b7c2d58bff95dee109efc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc">AssimilationNet</a></td></tr>
<tr class="memdesc:a865730e6305b7c2d58bff95dee109efc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Net photosynthesis (umol CO2 m-2 s-1)  <a href="#a865730e6305b7c2d58bff95dee109efc">More...</a><br /></td></tr>
<tr class="separator:a865730e6305b7c2d58bff95dee109efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34baf0802902fdfcb2d1ed4de13fb2eb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a34baf0802902fdfcb2d1ed4de13fb2eb">AssimilationGross</a></td></tr>
<tr class="memdesc:a34baf0802902fdfcb2d1ed4de13fb2eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gross photosynthesis (umol CO2 m-2 s-1) (Adjusted for respiration)  <a href="#a34baf0802902fdfcb2d1ed4de13fb2eb">More...</a><br /></td></tr>
<tr class="separator:a34baf0802902fdfcb2d1ed4de13fb2eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8989059dc3203e1def79220d27519b04"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a8989059dc3203e1def79220d27519b04">Transpiration</a></td></tr>
<tr class="memdesc:a8989059dc3203e1def79220d27519b04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transpiration mol H2O m-2 s-1.  <a href="#a8989059dc3203e1def79220d27519b04">More...</a><br /></td></tr>
<tr class="separator:a8989059dc3203e1def79220d27519b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff0c48ce7b3ab2b984bd451cc9af579d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d">Tleaf</a></td></tr>
<tr class="memdesc:aff0c48ce7b3ab2b984bd451cc9af579d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Leaf temperature C.  <a href="#aff0c48ce7b3ab2b984bd451cc9af579d">More...</a><br /></td></tr>
<tr class="separator:aff0c48ce7b3ab2b984bd451cc9af579d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33ec7e3bbc0ace7cf04efbd46ac68b7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7">Ci</a></td></tr>
<tr class="memdesc:ab33ec7e3bbc0ace7cf04efbd46ac68b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal CO2 concentration umol mol-1.  <a href="#ab33ec7e3bbc0ace7cf04efbd46ac68b7">More...</a><br /></td></tr>
<tr class="separator:ab33ec7e3bbc0ace7cf04efbd46ac68b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50c7b57af404866a64d13704966d1d73"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73">StomatalConductance</a></td></tr>
<tr class="memdesc:a50c7b57af404866a64d13704966d1d73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stomatal conductance umol m-2 s-1.  <a href="#a50c7b57af404866a64d13704966d1d73">More...</a><br /></td></tr>
<tr class="separator:a50c7b57af404866a64d13704966d1d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d3909dbee9dd67c604e2eed4865734"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734">BoundaryLayerConductance</a></td></tr>
<tr class="memdesc:a00d3909dbee9dd67c604e2eed4865734"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boundary layer conductance umol m-2 s-1.  <a href="#a00d3909dbee9dd67c604e2eed4865734">More...</a><br /></td></tr>
<tr class="separator:a00d3909dbee9dd67c604e2eed4865734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b528f4b530d8f3307c17739c7ee62a6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a7b528f4b530d8f3307c17739c7ee62a6">DarkRespiration</a></td></tr>
<tr class="memdesc:a7b528f4b530d8f3307c17739c7ee62a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plant respiration umol m-2 s-1.  <a href="#a7b528f4b530d8f3307c17739c7ee62a6">More...</a><br /></td></tr>
<tr class="separator:a7b528f4b530d8f3307c17739c7ee62a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66f16f80971e5c5eede33113b0332d7a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a66f16f80971e5c5eede33113b0332d7a">VPD</a></td></tr>
<tr class="memdesc:a66f16f80971e5c5eede33113b0332d7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vapor Pressure Density, kPa */.  <a href="#a66f16f80971e5c5eede33113b0332d7a">More...</a><br /></td></tr>
<tr class="separator:a66f16f80971e5c5eede33113b0332d7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fc26a2af41fa283a18c5d237a15a971"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a3fc26a2af41fa283a18c5d237a15a971">Ci_Ca</a></td></tr>
<tr class="memdesc:a3fc26a2af41fa283a18c5d237a15a971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ratio of internal to external CO2, unitless.  <a href="#a3fc26a2af41fa283a18c5d237a15a971">More...</a><br /></td></tr>
<tr class="separator:a3fc26a2af41fa283a18c5d237a15a971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b544258c3eed5fa061e40fa3c742d0f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a1b544258c3eed5fa061e40fa3c742d0f">errTolerance</a></td></tr>
<tr class="memdesc:a1b544258c3eed5fa061e40fa3c742d0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error tolerance for iterations.  <a href="#a1b544258c3eed5fa061e40fa3c742d0f">More...</a><br /></td></tr>
<tr class="separator:a1b544258c3eed5fa061e40fa3c742d0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77de70f2ad2c944a44d09574098544ea"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a77de70f2ad2c944a44d09574098544ea">eqlTolerance</a></td></tr>
<tr class="memdesc:a77de70f2ad2c944a44d09574098544ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equality tolerance.  <a href="#a77de70f2ad2c944a44d09574098544ea">More...</a><br /></td></tr>
<tr class="separator:a77de70f2ad2c944a44d09574098544ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace0a89f55ea363701ca964af605b9944"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#ace0a89f55ea363701ca964af605b9944">iter_total</a></td></tr>
<tr class="memdesc:ace0a89f55ea363701ca964af605b9944"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of iterations.  <a href="#ace0a89f55ea363701ca964af605b9944">More...</a><br /></td></tr>
<tr class="separator:ace0a89f55ea363701ca964af605b9944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b4eee1a920250217a4f9468788ffd53"><td class="memItemLeft" align="right" valign="top">*std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a0b4eee1a920250217a4f9468788ffd53">PlantType</a></td></tr>
<tr class="memdesc:a0b4eee1a920250217a4f9468788ffd53"><td class="mdescLeft">&#160;</td><td class="mdescRight">For C3 or C4 designation */.  <a href="#a0b4eee1a920250217a4f9468788ffd53">More...</a><br /></td></tr>
<tr class="separator:a0b4eee1a920250217a4f9468788ffd53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b4071e10afdbc6879d155dc141ef379"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a7b4071e10afdbc6879d155dc141ef379">ConstantLeafTemperature</a></td></tr>
<tr class="memdesc:a7b4071e10afdbc6879d155dc141ef379"><td class="mdescLeft">&#160;</td><td class="mdescRight">if true, uses constant temperature - if true, does not solve for leaf temperature */  <a href="#a7b4071e10afdbc6879d155dc141ef379">More...</a><br /></td></tr>
<tr class="separator:a7b4071e10afdbc6879d155dc141ef379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4197e7648d565006d6ef69348370e357"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a4197e7648d565006d6ef69348370e357">iter1</a></td></tr>
<tr class="separator:a4197e7648d565006d6ef69348370e357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194faf8c006a5c21e6d25eb45a73760c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a194faf8c006a5c21e6d25eb45a73760c">iter2</a></td></tr>
<tr class="memdesc:a194faf8c006a5c21e6d25eb45a73760c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iteration counters.  <a href="#a194faf8c006a5c21e6d25eb45a73760c">More...</a><br /></td></tr>
<tr class="separator:a194faf8c006a5c21e6d25eb45a73760c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac945e291c67bc3a39e5a8cc3b2e147"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#acac945e291c67bc3a39e5a8cc3b2e147">iter_Ci</a></td></tr>
<tr class="memdesc:acac945e291c67bc3a39e5a8cc3b2e147"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iteration value for Ci umol mol-1, internal CO2 concentration.  <a href="#acac945e291c67bc3a39e5a8cc3b2e147">More...</a><br /></td></tr>
<tr class="separator:acac945e291c67bc3a39e5a8cc3b2e147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62fb21b7ee1c9a4f346a3fa0eb310acb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a62fb21b7ee1c9a4f346a3fa0eb310acb">isCiConverged</a></td></tr>
<tr class="memdesc:a62fb21b7ee1c9a4f346a3fa0eb310acb"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if Ci (internal CO2 concentration) iterations have converged.  <a href="#a62fb21b7ee1c9a4f346a3fa0eb310acb">More...</a><br /></td></tr>
<tr class="separator:a62fb21b7ee1c9a4f346a3fa0eb310acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class for gas exchange calculations<br />
This class simulates gas exchange in plant leaves for C3 and C4 plants. </p>
<p><br />
</p><dl class="section user"><dt>Usage</dt><dd><ul>
<li>Use <b>SetParams</b> to initialize the GasExchange object with parameters for a specific variety of plant</li>
<li>Use <b>SetVal</b> to pass environmental variables for a simulation and return a structure with output. <br />
See <a class="el" href="Interface.html">Interface</a> for details on input and output </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00088">88</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a050cd969516229a8c9e81d3f4fbd8c93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">photomod::CGasExchange::CGasExchange </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the constructor. </p>
<p>Constructor - initialization of some variables is done here. </p>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00037">37</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    { </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a62fb21b7ee1c9a4f346a3fa0eb310acb" title="True if Ci (internal CO2 concentration) iterations have converged. ">isCiConverged</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a1b544258c3eed5fa061e40fa3c742d0f" title="Error tolerance for iterations. ">errTolerance</a> = 0.001;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a77de70f2ad2c944a44d09574098544ea" title="Equality tolerance. ">eqlTolerance</a> = 1.0e-6;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a53029130b9501a86771ce1b3dc617a81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">photomod::CGasExchange::~CGasExchange </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the destructor. </p>
<p>Destructor - nothing is done here </p>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00053">53</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a84f459cce51fbef9289fa51e646d82db"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::CalcStomatalConductance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stomatal conductance (mol m-2 s-1) </p>
<p>calculates and returns stomatal conductance for CO2 in umol CO2 m-2 s-1 Uses Ball-Berry model.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d" title="Saturated vapor pressure at given temperature. ">Es()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>stomatal conductance for CO2 umol m-2 s-1 </dd></dl>
<p><b>Ds</b>, VPD at leaf surface</p>
<p><b>aa</b>, a value in quadratic equation</p>
<p><b>bb</b>, b value in quadratic equation</p>
<p><b>cc</b>, calcuation variable (x) in quadratic equation</p>
<p><b>hs</b>, solution for relative humidity</p>
<p><b>Cs</b>, estimate of mole fraction of CO2 at the leaf surface</p>
<p><b>Gamma</b>, CO2 compensation point in the absence of mitochondirial respiration, in ubar</p>
<p><b>StomatalConductance</b>, temporary variable to hold stomatal conductance </p>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00394">394</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">//** \code</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordtype">double</span> Ds, </div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            aa,    </div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            bb,    </div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            cc,    </div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            hs,    </div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            Cs,    </div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            Gamma, </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a>;    </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        Gamma = 10.0; </div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">//** \endcode</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordtype">double</span> P=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>/100;  </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        Cs = (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a> - (1.37*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>))*P; <span class="comment">// surface CO2 in mole fraction</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">if</span> (Cs == Gamma) Cs = Gamma + 1;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">if</span> (Cs &lt;= Gamma) Cs = Gamma + 1;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// Quadratic equation to obtain hs by combining StomatalConductance with diffusion equation</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        aa = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ad40a8a1250af0984f3803236193e3a11">g1</a>*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>/Cs;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        bb = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>+<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>-(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ad40a8a1250af0984f3803236193e3a11">g1</a>*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>/Cs);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        cc = (-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a58f7d4d251727e692ac8fbad2fb57956" title="Relative Humidity (%, i.e., 80) ">RH</a>*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>)-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        hs = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a60529d982d8ff5172e3f8f26ad752c60" title="Upper part of quadratic equation solution. ">QuadSolnUpper</a>(aa,bb,cc);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">if</span> (hs &gt; 1) hs = 1;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">if</span> (hs&lt;0) hs = 0;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        Ds = (1-hs)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d" title="Saturated vapor pressure at given temperature. ">Es</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>); <span class="comment">// VPD at leaf surface</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        StomatalConductance = (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>+<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ad40a8a1250af0984f3803236193e3a11">g1</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>*hs/Cs));</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (StomatalConductance &lt; <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>) StomatalConductance=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>; <span class="comment">//Limit StomatalConductance to mesophyll conductance </span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a>;  <span class="comment">// moles m-2 s-1</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6b9eba78c508968ed95404a1cdaa4a7f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::CalcTurbulentVaporConductance </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Conductance for turbulant vapor transfer in air - forced convection (mol m-2 s-1) </p>
<p>calculates conductance for turbulant vapor transfer in air - forced convection </p><dl class="section return"><dt>Returns</dt><dd>conductance for turbulent vapor transfer in air (mol m-2 s-1)</dd></dl>
<p>&lt; temporary holding variable for stomatal ratio calculations</p>
<p>&lt; characteristic dimension of leaf </p>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00438">438</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordtype">double</span> ratio; </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordtype">double</span> Char_Dim; </div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        ratio = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aaaf6c1a776c7562827048da056b07d97" title="Squares number. ">Square</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a785c0cbc81d8882bbf01e150404e33dc">stomaRatio</a>+1)/(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aaaf6c1a776c7562827048da056b07d97" title="Squares number. ">Square</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a785c0cbc81d8882bbf01e150404e33dc">stomaRatio</a>)+1);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        Char_Dim = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a7f6b8d73fdb9042d123e2b8e32effd49">LfWidth</a>*0.72; <span class="comment">// characteristic dimension of a leaf, leaf width in m</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="comment">// wind is in m per second</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">return</span> (1.4*0.147*sqrt(__max(0.1,<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae45cf7c89cde073d1aa2eece25727388" title="Windspeed at 2 meters (km s-1) ">wind</a>)/Char_Dim))*ratio; </div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">// multiply by 1.4 for outdoor condition, Campbell and Norman (1998), p109, gva</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">// multiply by ratio to get the effective blc (per projected area basis), licor 6400 manual p 1-9</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2c0002b03cb9847bad2467fb12692a40"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void photomod::CGasExchange::EnergyBalance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculates leaf temperature and transpiration </p>
<p>Calculates Transpiration rate (T) and leaf temperature (Tleaf).</p>
<p>Iterates by recalculating photosynthesis until leaf temperatures converge</p>
<p>See Campbell and Norman (1998) pp 224-225</p>
<p>Because Stefan-Boltzman constant is for unit surface area by denifition, all terms including sbc are multilplied by 2 (i.e., RadiativeConductance, thermal radiation)</p>
<p>Does not have input</p>
<dl class="section return"><dt>Returns</dt><dd>nothing but calculates transpiration (T) and leaf temperature (Tleaf) </dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00324">324</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> Lambda = 44000; <span class="comment">//latent heat of vaporization of water J mol-1 - not used in this implementation</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> Cp = 29.3; <span class="comment">// thermodynamic psychrometer constant and specific hear of air, J mol-1 C-1</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> psc = 6.66e-4; <span class="comment">//psycrometric constant units are C-1</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">//psc=Cp/Lambda = 29.3/44000 See Campbell and Norman, pg 232, after eq 14.11</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">//The following are secondary variables used in the energy balance</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordtype">double</span> HeatConductance,  <span class="comment">//heat conductance J m-2 s-1</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            VaporConductance, <span class="comment">//vapor conductance ratio of stomatal and heat conductance mol m-2 s-1</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            RadiativeConductance, <span class="comment">//radiative conductance J m-2 s-1</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            RadiativeAndHeatConductance, <span class="comment">//radiative+heat conductance</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            psc1,  <span class="comment">// apparent psychrometer constant Campbell and Norman, page 232 after eq 14.11</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            Ea,   <span class="comment">//ambient vapor pressure kPa</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            thermal_air; <span class="comment">// emitted thermal radiation Watts  m-2</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordtype">double</span> lastTi, newTi;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordtype">int</span>    iter;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        HeatConductance = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>*(0.135/0.147);  <span class="comment">// heat conductance, HeatConductance = 1.4*.135*sqrt(u/d), u is the wind speed in m/s} Boundary Layer Conductance to Heat</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// Since BoundaryLayerConductance is .147*sqrt(u/d) this scales to 0.135*sqrt(u/d) - HeatConductance on page 109 of Campbell and Norman, 1998</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// Wind was accounted for in BoundaryLayerConductance already  as BoundaryLayerConductance (turbulent vapor transfer) was calculated from CalcTurbulentVaporConductance() in GasEx. </span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// units are J m-2 s-1 </span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        VaporConductance = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a>*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>/(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a>+<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>);      <span class="comment">//vapor conductance, StomatalConductance is stomatal conductance and is given as gvs in Campbell and Norman.      </span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                                                                                                            <span class="comment">// note units are moles m-2 s-1. </span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        RadiativeConductance = (4*<a class="code" href="gas__exchange_8cpp.html#a06b50f1ca7258a9862c39d3ed354bf7c" title="epsilon emissivity See Campbell and Norman, 1998, page 163 (CHECK) ">epsilon</a>*<a class="code" href="gas__exchange_8cpp.html#ada271add7d89f3d2024059f00fcb0a4f" title="stefan-Boltzmann constant Wm-2 k-4. ">sbc</a>*pow(273+<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>,3)/Cp)*2; <span class="comment">// radiative conductance, *2 account for both sides</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        RadiativeAndHeatConductance = HeatConductance + RadiativeConductance;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        thermal_air = <a class="code" href="gas__exchange_8cpp.html#a06b50f1ca7258a9862c39d3ed354bf7c" title="epsilon emissivity See Campbell and Norman, 1998, page 163 (CHECK) ">epsilon</a>*<a class="code" href="gas__exchange_8cpp.html#ada271add7d89f3d2024059f00fcb0a4f" title="stefan-Boltzmann constant Wm-2 k-4. ">sbc</a>*pow(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>+273,4)*2; <span class="comment">//Multiply by 2 for both surfaces</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        psc1 = psc*RadiativeAndHeatConductance/VaporConductance; </div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a66f16f80971e5c5eede33113b0332d7a" title="Vapor Pressure Density, kPa */. ">VPD</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d" title="Saturated vapor pressure at given temperature. ">Es</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>)*(1-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a58f7d4d251727e692ac8fbad2fb57956" title="Relative Humidity (%, i.e., 80) ">RH</a>); <span class="comment">// vapor pressure deficit Es is saturation vapor pressure at air temperature</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">// iterative version</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        newTi=-10;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        iter=0;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        lastTi=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordtype">double</span> Res, dRes; <span class="comment">//temporary variables</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordtype">double</span> thermal_leaf;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        Ea = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d" title="Saturated vapor pressure at given temperature. ">Es</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a58f7d4d251727e692ac8fbad2fb57956" title="Relative Humidity (%, i.e., 80) ">RH</a>; <span class="comment">// ambient vapor pressure</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">while</span> ((abs(lastTi-newTi)&gt;0.001) &amp;&amp; (iter &lt;<a class="code" href="gas__exchange_8cpp.html#a7124222c9d33e5ccfb2aca8d29b38b56" title="maxiter maximum number of iterations ">maxiter</a>)) </div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            lastTi=newTi;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>= <a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a> + (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acaf96c972db93276390570b52e2f4efa" title="Absorbed incident radiation (watts m-2) ">R_abs</a>- thermal_air-Lambda*VaporConductance*this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a66f16f80971e5c5eede33113b0332d7a" title="Vapor Pressure Density, kPa */. ">VPD</a>/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>)/(Cp*RadiativeAndHeatConductance+Lambda*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a450c0f7a9613bad31be095c88c9e9121" title="Slope of the vapor pressure curve. ">Slope</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>)*VaporConductance); <span class="comment">// eqn 14.6a</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            thermal_leaf=<a class="code" href="gas__exchange_8cpp.html#a06b50f1ca7258a9862c39d3ed354bf7c" title="epsilon emissivity See Campbell and Norman, 1998, page 163 (CHECK) ">epsilon</a>*<a class="code" href="gas__exchange_8cpp.html#ada271add7d89f3d2024059f00fcb0a4f" title="stefan-Boltzmann constant Wm-2 k-4. ">sbc</a>*pow(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273,4)*2;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            Res = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#acaf96c972db93276390570b52e2f4efa" title="Absorbed incident radiation (watts m-2) ">R_abs</a> - thermal_leaf - Cp*HeatConductance*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a> - <a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>) - Lambda*VaporConductance*0.5*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d" title="Saturated vapor pressure at given temperature. ">Es</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>)-Ea)/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>; <span class="comment">// Residual function: f(Ti), KT Paw (1987)</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            dRes= -4*<a class="code" href="gas__exchange_8cpp.html#a06b50f1ca7258a9862c39d3ed354bf7c" title="epsilon emissivity See Campbell and Norman, 1998, page 163 (CHECK) ">epsilon</a>*<a class="code" href="gas__exchange_8cpp.html#ada271add7d89f3d2024059f00fcb0a4f" title="stefan-Boltzmann constant Wm-2 k-4. ">sbc</a>*pow(273+<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>,3)*2-Cp*HeatConductance*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-Lambda*VaporConductance*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a450c0f7a9613bad31be095c88c9e9121" title="Slope of the vapor pressure curve. ">Slope</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>); <span class="comment">// derivative of residual: f&#39;(Ti)</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            newTi = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a> + Res/dRes; <span class="comment">// newton-rhapson iteration</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            iter++;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>=newTi;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a8989059dc3203e1def79220d27519b04" title="Transpiration mol H2O m-2 s-1. ">Transpiration</a> =1000*VaporConductance*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d" title="Saturated vapor pressure at given temperature. ">Es</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>)-Ea)/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>; <span class="comment">//Don&#39;t need Lambda - cancels out see eq 14.10 in Campbell and Norman, 1998</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">// umol m-2 s-1. note 1000 converts from moles to umol since units of VaporConductance are moles. </span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a32e40db907f72c57d9ec546dee8fa75d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Es </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temperature</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Saturated vapor pressure at given temperature. </p>
<p>kPa </p>
<p>calculates and returns Saturation vapor pressure (kPa). Campbell and Norman (1998), p 41. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Temperature</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>saturated vapor pressure (kPa)</dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00455">455</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordtype">double</span> result;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// a=0.611 kPa, b=17.502 C and c=240.97 C </span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">//Units of Es are kPa</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        result=(0.611*exp(17.502*Temperature/(240.97+Temperature)));</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4dc539abc744407ed843a3ea8c77af11"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::EvalCi </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ci</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci and new Ci. </p>
<p>Called by <a class="el" href="classphotomod_1_1_c_gas_exchange.html#a337206050da05fc358a540556d2caff1" title="called iterively to find optimal internal CO2 concentration returns optimal internal CO2 concentratio...">SearchCi()</a> to calculate a new value of Ci for the current values of photosynthesis and stomatal conductance determined using parameters from a previous step where the energy balance was solved. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a337206050da05fc358a540556d2caff1" title="called iterively to find optimal internal CO2 concentration returns optimal internal CO2 concentratio...">SearchCi()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Ci</td><td>**, estimate of internal CO2 concentration, umol mol-1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the difference between the passed value of Ci (old)and the new one.</dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00561">561</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordtype">double</span> newCi;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a0b4eee1a920250217a4f9468788ffd53" title="For C3 or C4 designation */. ">PlantType</a>.compare(<span class="stringliteral">&quot;C3&quot;</span>)== 0) <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a0489552d5fb0005cc46e70942bdbba5f" title="Function to calculate C3 photosynthesis. ">PhotosynthesisC3</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7" title="Internal CO2 concentration umol mol-1. ">Ci</a>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a0b4eee1a920250217a4f9468788ffd53" title="For C3 or C4 designation */. ">PlantType</a>.compare(<span class="stringliteral">&quot;C4&quot;</span>)== 0) <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ac5c21e41dfb582c06f14f7fb26d708f1" title="Function to calculate C4 photosynthesis. ">PhotosynthesisC4</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7" title="Internal CO2 concentration umol mol-1. ">Ci</a>);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">if</span> (abs(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a>) &gt; <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a77de70f2ad2c944a44d09574098544ea" title="Equality tolerance. ">eqlTolerance</a>) </div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            newCi = max(1.0,<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a> - <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>*(1.6/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a>+1.37/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>)*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>/100.0));</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            newCi = max(1.0,<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a> - <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>*(1.6/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a77de70f2ad2c944a44d09574098544ea" title="Equality tolerance. ">eqlTolerance</a>+1.37/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>)*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>/100.0));</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">return</span> (newCi-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7" title="Internal CO2 concentration umol mol-1. ">Ci</a>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adc6695b31b7fc63f6b6e4941a102f9c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void photomod::CGasExchange::GasEx </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main module to calculate gas exchange rates. </p>
<p>carries out calculations for photosynthesis and stomatal conductance.</p>
<p>no parameters, returns nothing</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a337206050da05fc358a540556d2caff1" title="called iterively to find optimal internal CO2 concentration returns optimal internal CO2 concentratio...">SearchCi()</a>, </dd>
<dd>
<a class="el" href="classphotomod_1_1_c_gas_exchange.html#a2c0002b03cb9847bad2467fb12692a40" title="calculates leaf temperature and transpiration ">EnergyBalance()</a>, </dd>
<dd>
<a class="el" href="classphotomod_1_1_c_gas_exchange.html#a84f459cce51fbef9289fa51e646d82db" title="Stomatal conductance (mol m-2 s-1) ">CalcStomatalConductance()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>nothing </dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00145">145</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordtype">double</span> Tleaf_old;  <span class="comment">//previous leaf temperture (for iteration)</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordtype">int</span>   iter=1;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ace0a89f55ea363701ca964af605b9944" title="Total number of iterations. ">iter_total</a>=0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>; Tleaf_old = 0;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7" title="Internal CO2 concentration umol mol-1. ">Ci</a> = 0.7*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a6b9eba78c508968ed95404a1cdaa4a7f" title="Conductance for turbulant vapor transfer in air - forced convection (mol m-2 s-1) ...">CalcTurbulentVaporConductance</a>();</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a84f459cce51fbef9289fa51e646d82db" title="Stomatal conductance (mol m-2 s-1) ">CalcStomatalConductance</a>();</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">while</span> ((abs(Tleaf_old -<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>)&gt;0.01) &amp;&amp; (iter &lt; <a class="code" href="gas__exchange_8cpp.html#a7124222c9d33e5ccfb2aca8d29b38b56" title="maxiter maximum number of iterations ">maxiter</a>))</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            Tleaf_old=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7" title="Internal CO2 concentration umol mol-1. ">Ci</a>=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a337206050da05fc358a540556d2caff1" title="called iterively to find optimal internal CO2 concentration returns optimal internal CO2 concentratio...">SearchCi</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7" title="Internal CO2 concentration umol mol-1. ">Ci</a>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a>=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a84f459cce51fbef9289fa51e646d82db" title="Stomatal conductance (mol m-2 s-1) ">CalcStomatalConductance</a>();</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a2c0002b03cb9847bad2467fb12692a40" title="calculates leaf temperature and transpiration ">EnergyBalance</a>();</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a194faf8c006a5c21e6d25eb45a73760c" title="Iteration counters. ">iter2</a> =++iter; <span class="comment">//iter=iter+1, iter2=iter; </span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a7b4071e10afdbc6879d155dc141ef379" title="if true, uses constant temperature - if true, does not solve for leaf temperature */ ...">ConstantLeafTemperature</a>) <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        } </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada5f8c05c2f447fd2fa5d96a150cb435"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_AGross </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return gross photosynthesis (umol CO2 m-2 s-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00166">166</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7dfe13266ecb7ed5533da29252967108"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_ANet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return net photosynthesis (umol CO2 m-2 s-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00165">165</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a24df2395552c74860d753500c20a9c92"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_BoundaryLayerConductance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return boundary layer conductance (mol m-2 s-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00171">171</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6a05d6ae02f21fc9123620cf60e198e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_Ci </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return internal CO2 concentration (umol mol-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00169">169</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9a9bdc0eb2e7bb7b716186f96436fa17"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_CiCaRatio </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ratio between internal and atmospheric CO2. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00193">193</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5392cd5c6850f36e8d259259b2270c1a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_LeafTemperature </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return leaf temperature (C) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00168">168</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a261b64980edd972c9a095a7b765f2917"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_Respiration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return respiration rate (umol CO2 m-2 s-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00172">172</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="afd59e3c69511501eb1a3ad050a112b14"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_StomatalConductance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return stomatal conductance to water vapor (mol m-2 s-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00170">170</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8c222492610a8b385af08b963a81bdac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_Transpiration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return transpiration rate (umol H2O m-2 s-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00167">167</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="ade28cd8421d71ad5db0054dc94500412"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::get_VPD </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return vapor pressure deficit (kpa) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00173">173</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa10a6134ecf2bb59a4a719ece9573d32"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Min </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds minimum of three numbers. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00228">228</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad23c00de704b06ad8e6835e6b1fd4b60"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::minh </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fn1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fn2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hyperbolic minimum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fn1</td><td>first value to be compared for min </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fn2</td><td>second value to be compared for min </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theta2</td><td>curvature factor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>hyperbolic minimum</dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00617">617</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordtype">double</span> x, res;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        x = ((fn1+fn2)*(fn1+fn2)-4*theta2*fn1*fn2);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keywordflow">if</span> (x&lt;0)</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            res = min(fn1,fn2); </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">if</span> (theta2==0.0)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            res= fn1*fn2/(fn1+fn2);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            res = ((fn1+ fn2) - sqrt(x))/(2*theta2); <span class="comment">// hyperbolic minimum</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0489552d5fb0005cc46e70942bdbba5f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void photomod::CGasExchange::PhotosynthesisC3 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ci</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to calculate C3 photosynthesis. </p>
<p>Calculates photosynthesis for C3 plants <br />
 Uses as input incident PhotoFluxDensity, Air temp in C, CO2 in ppm, RH in per percent.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a85daf4befe81254dd962d4cd497cb1a8" title="sets input values for calculations for a particular set of environmental variables ...">SetVal()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Ci</td><td>- internal CO2 concentration, umol mol-1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nothing. </dd></dl>
<p>&lt; <b>Curvature</b> -factor of Av and Aj colimitation</p>
<p>&lt; <b>Kc25</b>, MM Constant of rubisco for CO2 of C3 plants (de Pury and Farquar, 1997) (umol m-2 s-1)</p>
<p>&lt; <b>Ko25</b>, MM Constant of rubiscuo for O2 from above reference (umol m-2 s-1)</p>
<p>&lt; <b>Eac</b>, Energy Activation kJ mol-1</p>
<p>&lt; <b>Eao</b>, activation energy values </p>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00172">172</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">//parameters for C3 Photosythesis; </span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> curvature=0.999 ; </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span>       Kc25 = 404;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span>       Ko25 = 278;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span>      Eac = 59400;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span>       Eao = 36000;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">//** \endcode</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="comment">// These variables hold temporary calculations</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordtype">double</span> alpha, Kc, Ko, gamma, Ia,Jmax, Vcmax, TPU, J, Av, Aj, Ap, Ac, Km, Ca, Cc, P;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        gamma = 36.9 + 1.88*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)+0.036*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aaaf6c1a776c7562827048da056b07d97" title="Squares number. ">Square</a>(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25);  <span class="comment">// CO2 compensation point in the absence of mitochondirial respiration, in ubar}</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">//* Light response function parameters */</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        Ia = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aabd821405fe6b92ccdacbeeaa582198b" title="Photosynthetic Flux Density (umol photons m-2 s-1. ">PhotoFluxDensity</a>*(1-<a class="code" href="gas__exchange_8cpp.html#aba6693c63aa83b56346019dd4f7d0640" title="leaf reflectance + transmittance ">scatt</a>);    <span class="comment">//* absorbed irradiance */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        alpha = (1-<a class="code" href="gas__exchange_8cpp.html#a7a51ed112e9b79f89e3e70beb8db8bf5" title="spectral correction ">f</a>)/2; <span class="comment">// *!apparent quantum efficiency, params adjusted to get value 0.3 for average C3 leaf</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a> = 0;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="comment">//* other input parameters and constants */</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        P  = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>/100; <span class="comment">//Press is kPa. Used to convert mole fraction to partial pressure</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        Ca = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a>*P; <span class="comment">//* conversion to partial pressure */ </span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        Kc = Kc25*exp(Eac*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)));</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        Ko = Ko25*exp(Eao*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)));</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        Km = Kc*(1+<a class="code" href="gas__exchange_8cpp.html#a396fecfabe3105afc15a61c209f910f0" title="Oxygen partial pressure gas units are mbar. ">O</a>/Ko); <span class="comment">//* effective M-M constant for Kc in the presence of O2 */</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a7b528f4b530d8f3307c17739c7ee62a6" title="Plant respiration umol m-2 s-1. ">DarkRespiration</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a9112c229f92b96f49091a88dfee35429">Rd25</a>*exp(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aa072e558962f1fddb5458dc6e574299c">Ear</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)));</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        Jmax = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a5255a4946a9ce85a86904bda6a115b88">Jm25</a>*exp(((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a908435e79fdcaaa88aa650ed7fd1737b">Eaj</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)*298))*</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            (1+exp((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a716447c8d882c31573c567aec57b5632">Sj</a>*298-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#acbcaf75f6438f9d23454de80c30b3e3d">Hj</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*298)))/</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            (1+exp((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a716447c8d882c31573c567aec57b5632">Sj</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#acbcaf75f6438f9d23454de80c30b3e3d">Hj</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)))); <span class="comment">// de Pury 1997</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        Vcmax = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6e11a3ad51dc4447ee9419d6c46644dd">Vcm25</a>*exp(((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a4cf11d6ad4a6a780aa8e28d259c7ba98">EaVc</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)*298))*</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            (1+exp((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aee3088c5f1206ca28d2ae1287c89f86e">Sv</a>*298-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ab5ce6078a0194f081dc0abf22a5ec5c8">Hv</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*298)))/</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            (1+exp((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aee3088c5f1206ca28d2ae1287c89f86e">Sv</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ab5ce6078a0194f081dc0abf22a5ec5c8">Hv</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)))); <span class="comment">// Used peaked response, DHF</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        TPU = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aed0f1782f42b765ef758331f70c6bed2">TPU25</a>*exp(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6835251dce45cbdea7cf0139d60929a1">Eap</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        Cc = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7" title="Internal CO2 concentration umol mol-1. ">Ci</a>; <span class="comment">// assume infinite gi</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a84f459cce51fbef9289fa51e646d82db" title="Stomatal conductance (mol m-2 s-1) ">CalcStomatalConductance</a>(); <span class="comment">// Initial value</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a00d3909dbee9dd67c604e2eed4865734" title="Boundary layer conductance umol m-2 s-1. ">BoundaryLayerConductance</a>=  <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a6b9eba78c508968ed95404a1cdaa4a7f" title="Conductance for turbulant vapor transfer in air - forced convection (mol m-2 s-1) ...">CalcTurbulentVaporConductance</a>();</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        Av = (Vcmax*(Cc-gamma))/(Cc+Km);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        J =  (((alpha*Ia + Jmax) - sqrt(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aaaf6c1a776c7562827048da056b07d97" title="Squares number. ">Square</a>(alpha*Ia+Jmax) - 4*alpha*Ia*(Jmax)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a3ab5e6190294750faa6cab86a67ed440">Theta</a>)) / (2*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a3ab5e6190294750faa6cab86a67ed440">Theta</a>)) ;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        Aj = J*(Cc-gamma)/(4*(Cc+2*gamma));</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        Ap = 3*TPU;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        Ac = ((Av+Aj) - sqrt(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aaaf6c1a776c7562827048da056b07d97" title="Squares number. ">Square</a>(Av+Aj)-4*curvature*Av*Aj))/(2*curvature); <span class="comment">// curvatureaccount for colimitation between Av and Aj */</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">if</span> (Cc &gt; gamma) </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a> = min(Ac, Ap) -<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a7b528f4b530d8f3307c17739c7ee62a6" title="Plant respiration umol m-2 s-1. ">DarkRespiration</a>; </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a> = Av-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a7b528f4b530d8f3307c17739c7ee62a6" title="Plant respiration umol m-2 s-1. ">DarkRespiration</a>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a34baf0802902fdfcb2d1ed4de13fb2eb" title="Gross photosynthesis (umol CO2 m-2 s-1) (Adjusted for respiration) ">AssimilationGross</a> = max(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>+DarkRespiration,0.0);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a84f459cce51fbef9289fa51e646d82db" title="Stomatal conductance (mol m-2 s-1) ">CalcStomatalConductance</a>(); <span class="comment">// Update StomatalConductance using new value of AssimilationNet</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac5c21e41dfb582c06f14f7fb26d708f1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void photomod::CGasExchange::PhotosynthesisC4 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ci</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to calculate C4 photosynthesis. </p>
<p>Calculates photosynthesis for C4 plants.</p>
<p>Requires Incident PhotoFluxDensity, Air temp in C, CO2 in ppm, RH in percent </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a85daf4befe81254dd962d4cd497cb1a8" title="sets input values for calculations for a particular set of environmental variables ...">SetVal()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Ci</td><td>- internal CO2 concentration, umol mol-1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nothing </dd></dl>
<p>&lt; <b>curvature</b> factor of Av and Aj colimitation</p>
<p>&lt; <b>Kc25</b>, Michaelis constant of rubisco for CO2 of C4 plants (2.5 times that of tobacco), ubar, Von Caemmerer 2000</p>
<p>&lt; <b>Ko25</b>, Michaelis constant of rubisco for O2 (2.5 times C3), mbar</p>
<p>&lt;<b>Kp</b>, <b>Kc</b>, <b>Ko</b>, <b>Km</b>, Calculated Michaelis params as a function of temperature </p>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00237">237</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>    curvature=0.995; </div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span>       Kc25 = 650,    </div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            Ko25 = 450,                </div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            Kp25 = 57;                 <span class="comment">//*!&lt; \b Kp25, Michaelis constant for PEP caboxylase for CO2 - was 60 in Kim&#39;s paper */</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span>       Eao = 36000;  <span class="comment">//*!&lt; \b EAO, activation energy for Ko */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span>       Vpr25 = 80;    <span class="comment">//*!&lt;   \b Vpr25, PEP regeneration limited Vp at 25C, value adopted from vC book */</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>    gbs = 0.003;   <span class="comment">//*!&lt; \b gbs, bundle sheath conductance to CO2, umol m-2 s-1 gbs x Cm is the inward diffusion of CO2 into the bundle sheath  */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>    x = 0.4;       <span class="comment">//*!&lt; \b x Partitioning factor of J, yield maximal J at this value */</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>    alpha = 0.001; <span class="comment">//*!&lt; \b alpha, fraction of PSII activity in the bundle sheath cell, very low for NADP-ME types  */</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>    gi = 5.0;      <span class="comment">//*!&lt; \b gi, conductance to CO2 from intercelluar to mesophyle, mol m-2 s-1, assumed  was 1, changed to 5 as per Soo 6/2012*/</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>    beta = 0.99;   <span class="comment">//*!&lt; \b beta, smoothing factor */</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>    gamma1 = 0.193; <span class="comment">//*!&lt; \b gamma1, half the reciprocal of rubisco specificity, to account for O2 dependence of CO2 comp point, note that this become the same as that in C3 model when multiplied by [O2] */</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordtype">double</span> Kp, Kc, Ko, Km;         </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordtype">double</span> Ia, I2;                 <span class="comment">// secondary calculated light variables</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordtype">double</span> Vpmax, Jmax, Vcmax, Eac, Om, Rm, J, Ac1, Ac2, Ac, Aj1,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            Aj2, Aj, Vp1, Vp2, Vp, P,  Ca, Cm, Vpr,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            Os, GammaStar, Gamma, a1, b1, c1; <span class="comment">//secondary calculated variables</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">//* Light response function parameters */</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        Ia = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aabd821405fe6b92ccdacbeeaa582198b" title="Photosynthetic Flux Density (umol photons m-2 s-1. ">PhotoFluxDensity</a>*(1-<a class="code" href="gas__exchange_8cpp.html#aba6693c63aa83b56346019dd4f7d0640" title="leaf reflectance + transmittance ">scatt</a>);    <span class="comment">//* absorbed irradiance */</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        I2 = Ia*(1-<a class="code" href="gas__exchange_8cpp.html#a7a51ed112e9b79f89e3e70beb8db8bf5" title="spectral correction ">f</a>)/2;    <span class="comment">//* useful light absorbed by PSII */</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">//* other input parameters and constants */</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        P  = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>/100;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        Ca = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a>*P; <span class="comment">//* conversion to partial pressure Atmospheric partial pressure of CO2, kPa*/</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        Om = <a class="code" href="gas__exchange_8cpp.html#a396fecfabe3105afc15a61c209f910f0" title="Oxygen partial pressure gas units are mbar. ">O</a>;   <span class="comment">//* mesophyle O2 partial pressure */</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        Eac=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a4cf11d6ad4a6a780aa8e28d259c7ba98">EaVc</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        Kp = Kp25*pow(<a class="code" href="gas__exchange_8cpp.html#a693e3a9063a1e7582e682ffd4fe06f46" title="Q10 factor. ">Q10</a>,(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25.0)/10.0);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        Vpr = Vpr25*pow(<a class="code" href="gas__exchange_8cpp.html#a693e3a9063a1e7582e682ffd4fe06f46" title="Q10 factor. ">Q10</a>,(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25.0)/10.0);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        Kc = Kc25*exp(Eac*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273))); <span class="comment">//Kc adjusted for temperature</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        Ko = Ko25*exp(Eao*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)));</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        Km = Kc*(1+Om/Ko); <span class="comment">//* effective M-M constant for Kc in the presence of O2 */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a7b528f4b530d8f3307c17739c7ee62a6" title="Plant respiration umol m-2 s-1. ">DarkRespiration</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a9112c229f92b96f49091a88dfee35429">Rd25</a>*exp(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aa072e558962f1fddb5458dc6e574299c">Ear</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">// The following are Arrhenius Equations for parameter temperature dependencies</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// Vpm25 (PEPC activity rate) , Vcm25  (Rubisco Capacity rate) and Jm25 (Whole chain electron transport rate) are the rates at 25C for Vp, Vc and Jm</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        Vpmax = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a92fb38cc21d9447dd3cdcb2e520c62ab">Vpm25</a>*exp(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a0c49423061797f7e071607f3d8288b2e">EaVp</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)));</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        Vcmax = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6e11a3ad51dc4447ee9419d6c46644dd">Vcm25</a>*exp(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a4cf11d6ad4a6a780aa8e28d259c7ba98">EaVc</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>-25)/(298*<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)));</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        Jmax = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a5255a4946a9ce85a86904bda6a115b88">Jm25</a>*exp((((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)-298)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a908435e79fdcaaa88aa650ed7fd1737b">Eaj</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)*298))*(1+exp((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a716447c8d882c31573c567aec57b5632">Sj</a>*298-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#acbcaf75f6438f9d23454de80c30b3e3d">Hj</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*298)))</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            /(1+exp((<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a716447c8d882c31573c567aec57b5632">Sj</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273)-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#acbcaf75f6438f9d23454de80c30b3e3d">Hj</a>)/(<a class="code" href="gas__exchange_8cpp.html#a5c71a5e59a53413cd6c270266d63b031" title="R idealgasconstant ">R</a>*(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aff0c48ce7b3ab2b984bd451cc9af579d" title="Leaf temperature C. ">Tleaf</a>+273.0))));</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        Rm = 0.5*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a7b528f4b530d8f3307c17739c7ee62a6" title="Plant respiration umol m-2 s-1. ">DarkRespiration</a>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        Cm=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab33ec7e3bbc0ace7cf04efbd46ac68b7" title="Internal CO2 concentration umol mol-1. ">Ci</a>; <span class="comment">//* mesophyle CO2 partial pressure, ubar, one may use the same value as Ci assuming infinite mesohpyle conductance */</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordtype">double</span> gs_last=0;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a84f459cce51fbef9289fa51e646d82db" title="Stomatal conductance (mol m-2 s-1) ">CalcStomatalConductance</a>();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        Vp1 = (Cm*Vpmax)/(Cm+Kp); <span class="comment">//* PEP carboxylation rate, that is the rate of C4 acid generation  Eq 1 in Kim 2007*/</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        Vp2 = Vpr;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        Vp = __max(__min(Vp1, Vp2),0);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">//* Enzyme limited A (Rubisco or PEP carboxylation */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        Ac1 = (Vp+gbs*Cm-Rm);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        Ac2 = (Vcmax-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a7b528f4b530d8f3307c17739c7ee62a6" title="Plant respiration umol m-2 s-1. ">DarkRespiration</a>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment">//* Quadratic expression to solve for Ac */</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        a1 = 1-(alpha/0.047)*(Kc/Ko);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        b1 = -(Ac1 + Ac2 + gbs*Km + (alpha/0.047)*(gamma1*Vcmax + DarkRespiration*Kc/Ko));</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        c1 = Ac1*Ac2-(Vcmax*gbs*gamma1*Om+DarkRespiration*gbs*Km);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        Ac = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4d206e8ffab6c56c2fb66cc3c02ab827" title="Lower part of quadratic equation solution. ">QuadSolnLower</a>(a1,b1,c1);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        Ac = __min(Ac1,Ac2);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">//* Light and electron transport limited  A mediated by J */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        J=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ad23c00de704b06ad8e6835e6b1fd4b60" title="Hyperbolic minimum. ">minh</a>(I2,Jmax,<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a3ab5e6190294750faa6cab86a67ed440">Theta</a>);  <span class="comment">//* rate of electron transport */</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        Aj1 = (x*J/2-Rm+gbs*Cm);  <span class="comment">// Eq 4 in Kim, 2007</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        Aj2 = (1-x)*J/3-DarkRespiration;       <span class="comment">//Eq 4 in Kim, 2007</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        Aj = __min(Aj1,Aj2);      <span class="comment">//Eq 4 in Kim, 2007</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a> = ((Ac+Aj) - sqrt(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aaaf6c1a776c7562827048da056b07d97" title="Squares number. ">Square</a>(Ac+Aj)-4*beta*Ac*Aj))/(2*beta); <span class="comment">//* smooting the transition between Ac and Aj */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ad23c00de704b06ad8e6835e6b1fd4b60" title="Hyperbolic minimum. ">minh</a>(Ac,Aj, curvature);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        gs_last=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a50c7b57af404866a64d13704966d1d73" title="Stomatal conductance umol m-2 s-1. ">StomatalConductance</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        Os = alpha*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a>/(0.047*gbs)+Om; <span class="comment">//* Bundle sheath O2 partial pressure, mbar */</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        GammaStar = gamma1*Os;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        Gamma = (DarkRespiration*Km + Vcmax*GammaStar)/(Vcmax-DarkRespiration);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a34baf0802902fdfcb2d1ed4de13fb2eb" title="Gross photosynthesis (umol CO2 m-2 s-1) (Adjusted for respiration) ">AssimilationGross</a> = __max(0, <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a865730e6305b7c2d58bff95dee109efc" title="Net photosynthesis (umol CO2 m-2 s-1) ">AssimilationNet</a> + DarkRespiration); </div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4d206e8ffab6c56c2fb66cc3c02ab827"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::QuadSolnLower </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lower part of quadratic equation solution. </p>
<p>solves the lower part of the quadratic equation ax2+bx=c</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lower portion of x</dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00602">602</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">if</span> (a==0) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((b*b - 4*a*c) &lt; 0) <span class="keywordflow">return</span> -b/a;   <span class="comment">//imaginary roots</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">else</span>  <span class="keywordflow">return</span> (-b-sqrt(b*b-4*a*c))/(2*a);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a60529d982d8ff5172e3f8f26ad752c60"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::QuadSolnUpper </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Upper part of quadratic equation solution. </p>
<p>solves the uppper part of the quadratic equation ax2+bx2=c</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lower portion of x </dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00587">587</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">if</span> (a==0) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((b*b - 4*a*c) &lt; 0) <span class="keywordflow">return</span> -b/a;   <span class="comment">//imaginary roots</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">else</span>  <span class="keywordflow">return</span> (-b+sqrt(b*b-4*a*c))/(2*a);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a337206050da05fc358a540556d2caff1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::SearchCi </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CO2i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>called iterively to find optimal internal CO2 concentration returns optimal internal CO2 concentration (CO2i) </p>
<p>does a secant search to find the optimal internal CO2 concentration (ci) Calls: </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CO2i</td><td>- internal CO2 concentration, (umol mol-1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Ci (umol mol-1)</dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00488">488</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordtype">int</span> iter;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordtype">double</span> fprime, Ci1, Ci2, Ci_low, Ci_hi, Ci_m;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordtype">double</span> temp;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        Ci1 = CO2i;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        Ci2 = CO2i + 1.0;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        Ci_m = (Ci1+Ci2)/2.0;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#acac945e291c67bc3a39e5a8cc3b2e147" title="Iteration value for Ci umol mol-1, internal CO2 concentration. ">iter_Ci</a> = 0;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        iter = 0;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a62fb21b7ee1c9a4f346a3fa0eb310acb" title="True if Ci (internal CO2 concentration) iterations have converged. ">isCiConverged</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">do</span> </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            iter++;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="comment">//Secant search method</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="keywordflow">if</span> (abs(Ci1-Ci2) &lt;= <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a1b544258c3eed5fa061e40fa3c742d0f" title="Error tolerance for iterations. ">errTolerance</a>) {<span class="keywordflow">break</span>;}</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="keywordflow">if</span> (iter &gt;= <a class="code" href="gas__exchange_8cpp.html#a7124222c9d33e5ccfb2aca8d29b38b56" title="maxiter maximum number of iterations ">maxiter</a>) </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a62fb21b7ee1c9a4f346a3fa0eb310acb" title="True if Ci (internal CO2 concentration) iterations have converged. ">isCiConverged</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            fprime = (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci2)-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci1))/(Ci2-Ci1);  <span class="comment">// f&#39;(Ci)</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">if</span> (fprime != 0.0) </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                Ci_m = max(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a1b544258c3eed5fa061e40fa3c742d0f" title="Error tolerance for iterations. ">errTolerance</a>, Ci1-<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci1)/fprime);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                Ci_m = Ci1;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            Ci1 = Ci2;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            Ci2 = Ci_m;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            temp=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci_m);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordtype">double</span> temp2=<a class="code" href="gas__exchange_8cpp.html#a7124222c9d33e5ccfb2aca8d29b38b56" title="maxiter maximum number of iterations ">maxiter</a>;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        } <span class="keywordflow">while</span> ((abs(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci_m)) &gt;= <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a1b544258c3eed5fa061e40fa3c742d0f" title="Error tolerance for iterations. ">errTolerance</a>) || (iter &lt; <a class="code" href="gas__exchange_8cpp.html#a7124222c9d33e5ccfb2aca8d29b38b56" title="maxiter maximum number of iterations ">maxiter</a>));</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">// C4 photosynthesis fails to converge at low soil water potentials using secant search, 6/8/05 SK</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="comment">// Bisectional type search is slower but more secure</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">//Bisectional search</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">if</span> (iter &gt; <a class="code" href="gas__exchange_8cpp.html#a7124222c9d33e5ccfb2aca8d29b38b56" title="maxiter maximum number of iterations ">maxiter</a>)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            Ci_low = 0.0;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            Ci_hi = 2.0*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a62fb21b7ee1c9a4f346a3fa0eb310acb" title="True if Ci (internal CO2 concentration) iterations have converged. ">isCiConverged</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keywordflow">while</span> (abs(Ci_hi-Ci_low) &lt;= <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a1b544258c3eed5fa061e40fa3c742d0f" title="Error tolerance for iterations. ">errTolerance</a> || iter &gt; (<a class="code" href="gas__exchange_8cpp.html#a7124222c9d33e5ccfb2aca8d29b38b56" title="maxiter maximum number of iterations ">maxiter</a>*2))</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                Ci_m = (Ci_low + Ci_hi)/2;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                <span class="keywordflow">if</span> (abs(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci_low)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci_m)) &lt;= <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a77de70f2ad2c944a44d09574098544ea" title="Equality tolerance. ">eqlTolerance</a>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci_low)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci_m) &lt; 0.0) {Ci_hi = max(Ci_m, <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a1b544258c3eed5fa061e40fa3c742d0f" title="Error tolerance for iterations. ">errTolerance</a>);}</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci_m)*<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a4dc539abc744407ed843a3ea8c77af11" title="Calls photosynthesis modules to evaluate Ci dependent calculations returns difference between old Ci ...">EvalCi</a>(Ci_hi) &lt; 0.0)  {Ci_low = max(Ci_m, <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a1b544258c3eed5fa061e40fa3c742d0f" title="Error tolerance for iterations. ">errTolerance</a>);}</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <span class="keywordflow">else</span> {<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a62fb21b7ee1c9a4f346a3fa0eb310acb" title="True if Ci (internal CO2 concentration) iterations have converged. ">isCiConverged</a> = <span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        CO2i = Ci_m;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a3fc26a2af41fa283a18c5d237a15a971" title="Ratio of internal to external CO2, unitless. ">Ci_Ca</a> = CO2i/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#acac945e291c67bc3a39e5a8cc3b2e147" title="Iteration value for Ci umol mol-1, internal CO2 concentration. ">iter_Ci</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#acac945e291c67bc3a39e5a8cc3b2e147" title="Iteration value for Ci umol mol-1, internal CO2 concentration. ">iter_Ci</a> + iter;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ace0a89f55ea363701ca964af605b9944" title="Total number of iterations. ">iter_total</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ace0a89f55ea363701ca964af605b9944" title="Total number of iterations. ">iter_total</a> + iter;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">return</span> CO2i;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8fa270acbbeb85882ff4f8f5fff92da5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void photomod::CGasExchange::SetParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html">tParms</a> *&#160;</td>
          <td class="paramname"><em>sParms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>used to pass structure with parameters from the interface to the calculator </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a8fa270acbbeb85882ff4f8f5fff92da5" title="used to pass structure with parameters from the interface to the calculator ">SetParams</a> for definitions </dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00059">59</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {       </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a0b4eee1a920250217a4f9468788ffd53" title="For C3 or C4 designation */. ">PlantType</a>=<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ab6c0861fc8b0d5eba683abbe0eb7fee2">Type</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a0b4eee1a920250217a4f9468788ffd53" title="For C3 or C4 designation */. ">PlantType</a>.compare(<span class="stringliteral">&quot;C4&quot;</span>)==0)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6e11a3ad51dc4447ee9419d6c46644dd">Vcm25</a>  =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6e11a3ad51dc4447ee9419d6c46644dd">Vcm25</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a5255a4946a9ce85a86904bda6a115b88">Jm25</a>   =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a5255a4946a9ce85a86904bda6a115b88">Jm25</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a92fb38cc21d9447dd3cdcb2e520c62ab">Vpm25</a>  =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a92fb38cc21d9447dd3cdcb2e520c62ab">Vpm25</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a9112c229f92b96f49091a88dfee35429">Rd25</a>   =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a9112c229f92b96f49091a88dfee35429">Rd25</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a3ab5e6190294750faa6cab86a67ed440">Theta</a>  =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a3ab5e6190294750faa6cab86a67ed440">Theta</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a4cf11d6ad4a6a780aa8e28d259c7ba98">EaVc</a>   =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a4cf11d6ad4a6a780aa8e28d259c7ba98">EaVc</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a908435e79fdcaaa88aa650ed7fd1737b">Eaj</a>    =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a908435e79fdcaaa88aa650ed7fd1737b">Eaj</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#acbcaf75f6438f9d23454de80c30b3e3d">Hj</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#acbcaf75f6438f9d23454de80c30b3e3d">Hj</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a716447c8d882c31573c567aec57b5632">Sj</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a716447c8d882c31573c567aec57b5632">Sj</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a0c49423061797f7e071607f3d8288b2e">EaVp</a>   =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a0c49423061797f7e071607f3d8288b2e">EaVp</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aa072e558962f1fddb5458dc6e574299c">Ear</a>    =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aa072e558962f1fddb5458dc6e574299c">Ear</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ad40a8a1250af0984f3803236193e3a11">g1</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ad40a8a1250af0984f3803236193e3a11">g1</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a785c0cbc81d8882bbf01e150404e33dc">stomaRatio</a> =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a785c0cbc81d8882bbf01e150404e33dc">stomaRatio</a>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a7f6b8d73fdb9042d123e2b8e32effd49">LfWidth</a>    =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a7f6b8d73fdb9042d123e2b8e32effd49">LfWidth</a>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a0b4eee1a920250217a4f9468788ffd53" title="For C3 or C4 designation */. ">PlantType</a>.compare(<span class="stringliteral">&quot;C3&quot;</span>)==0)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6e11a3ad51dc4447ee9419d6c46644dd">Vcm25</a>  =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6e11a3ad51dc4447ee9419d6c46644dd">Vcm25</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a5255a4946a9ce85a86904bda6a115b88">Jm25</a>   =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a5255a4946a9ce85a86904bda6a115b88">Jm25</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aed0f1782f42b765ef758331f70c6bed2">TPU25</a>  =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aed0f1782f42b765ef758331f70c6bed2">TPU25</a>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a9112c229f92b96f49091a88dfee35429">Rd25</a>   =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a9112c229f92b96f49091a88dfee35429">Rd25</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a3ab5e6190294750faa6cab86a67ed440">Theta</a>  =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a3ab5e6190294750faa6cab86a67ed440">Theta</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a4cf11d6ad4a6a780aa8e28d259c7ba98">EaVc</a>   =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a4cf11d6ad4a6a780aa8e28d259c7ba98">EaVc</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a908435e79fdcaaa88aa650ed7fd1737b">Eaj</a>    =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a908435e79fdcaaa88aa650ed7fd1737b">Eaj</a>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#acbcaf75f6438f9d23454de80c30b3e3d">Hj</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#acbcaf75f6438f9d23454de80c30b3e3d">Hj</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a716447c8d882c31573c567aec57b5632">Sj</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a716447c8d882c31573c567aec57b5632">Sj</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ab5ce6078a0194f081dc0abf22a5ec5c8">Hv</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ab5ce6078a0194f081dc0abf22a5ec5c8">Hv</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aee3088c5f1206ca28d2ae1287c89f86e">Sv</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aee3088c5f1206ca28d2ae1287c89f86e">Sv</a>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6835251dce45cbdea7cf0139d60929a1">Eap</a>    =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a6835251dce45cbdea7cf0139d60929a1">Eap</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aa072e558962f1fddb5458dc6e574299c">Ear</a>    =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#aa072e558962f1fddb5458dc6e574299c">Ear</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>     =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a72bca4df1c328622ec7687948b016594">g0</a>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ad40a8a1250af0984f3803236193e3a11">g1</a>    =    <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#ad40a8a1250af0984f3803236193e3a11">g1</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a785c0cbc81d8882bbf01e150404e33dc">stomaRatio</a> =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a785c0cbc81d8882bbf01e150404e33dc">stomaRatio</a>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>.<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a7f6b8d73fdb9042d123e2b8e32effd49">LfWidth</a>    =   <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae2941a2ddaff5c03c5d5ef97f9ffabb4" title="Variable of type tParms. ">sParms</a>-&gt;<a class="code" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html#a7f6b8d73fdb9042d123e2b8e32effd49">LfWidth</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a85daf4befe81254dd962d4cd497cb1a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void photomod::CGasExchange::SetVal </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>PhotoFluxDensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CO2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Press</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ConstantTemperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sets input values for calculations for a particular set of environmental variables </p>
<p>Sets environment variables for a single execution of the module.</p>
<p>Calls <a class="el" href="classphotomod_1_1_c_gas_exchange.html#adc6695b31b7fc63f6b6e4941a102f9c4" title="Main module to calculate gas exchange rates. ">GasEx()</a> to calculate photosynthetic rate and stomatal conductance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotoFluxDensity</td><td>Photosynthetic Flux Density (umol Quanta m-2 s-1) (check) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Tair</td><td>Air Temperature (C) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CO2</td><td>CO2 concentration of the air (umol mol-1) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RH</td><td>Relative Humidity (%) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wind</td><td>Windspeed at 2.5 m, m s-1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Press</td><td>Atmospheric pressure (kpa m-2) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ConstantTemperature</td><td>boolian if true, leaf temperature=air temperature when calculating gas exchange </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nothing </dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00113">113</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aabd821405fe6b92ccdacbeeaa582198b" title="Photosynthetic Flux Density (umol photons m-2 s-1. ">PhotoFluxDensity</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aabd821405fe6b92ccdacbeeaa582198b" title="Photosynthetic Flux Density (umol photons m-2 s-1. ">PhotoFluxDensity</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordtype">double</span> PAR = (<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aabd821405fe6b92ccdacbeeaa582198b" title="Photosynthetic Flux Density (umol photons m-2 s-1. ">PhotoFluxDensity</a>/4.55); <span class="comment">//PAR is watts m-2</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">double</span> NIR = PAR; <span class="comment">// If total solar radiation unavailable, assume NIR the same energy as PAR waveband</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acaf96c972db93276390570b52e2f4efa" title="Absorbed incident radiation (watts m-2) ">R_abs</a> = (1-<a class="code" href="gas__exchange_8cpp.html#aba6693c63aa83b56346019dd4f7d0640" title="leaf reflectance + transmittance ">scatt</a>)*PAR + 0.15*NIR + 2*(<a class="code" href="gas__exchange_8cpp.html#a06b50f1ca7258a9862c39d3ed354bf7c" title="epsilon emissivity See Campbell and Norman, 1998, page 163 (CHECK) ">epsilon</a>*<a class="code" href="gas__exchange_8cpp.html#ada271add7d89f3d2024059f00fcb0a4f" title="stefan-Boltzmann constant Wm-2 k-4. ">sbc</a>*pow(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>+273,4)); <span class="comment">// times 2 for projected area basis</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="comment">// shortwave radiation (PAR (=0.85) + NIR (=0.15) solar radiation absorptivity of leaves: =~ 0.5</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">//transfer variables to local scope</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#aa69249f07aa4e7350dfdc8bc068f9ac2" title="CO2 concentration (umol mol-1 air) ">CO2</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a58f7d4d251727e692ac8fbad2fb57956" title="Relative Humidity (%, i.e., 80) ">RH</a> = __min(100.0, __max(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a58f7d4d251727e692ac8fbad2fb57956" title="Relative Humidity (%, i.e., 80) ">RH</a>, 10.0))/100;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#acd3e1c02f9ce0d34ea3795046bfec332" title="Air temperature at 2m, (C) ">Tair</a>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae45cf7c89cde073d1aa2eece25727388" title="Windspeed at 2 meters (km s-1) ">wind</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ae45cf7c89cde073d1aa2eece25727388" title="Windspeed at 2 meters (km s-1) ">wind</a>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        this-&gt;<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a> = <a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#a7b4071e10afdbc6879d155dc141ef379" title="if true, uses constant temperature - if true, does not solve for leaf temperature */ ...">ConstantLeafTemperature</a>=ConstantTemperature;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classphotomod_1_1_c_gas_exchange.html#adc6695b31b7fc63f6b6e4941a102f9c4" title="Main module to calculate gas exchange rates. ">GasEx</a>();   <span class="comment">// Gas exchange calculations here</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a450c0f7a9613bad31be095c88c9e9121"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Slope </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temperature</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Slope of the vapor pressure curve. </p>
<p>Calculates the slope of the sat vapor pressure curve: first order derivative of Es with respect to T.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Temperature</td><td>(C) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d" title="Saturated vapor pressure at given temperature. ">Es()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>slope of the vapor pressure curve kPa T-1 </dd></dl>

<p>Definition at line <a class="el" href="gas__exchange_8cpp_source.html#l00470">470</a> of file <a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordtype">double</span> VPSlope;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">// units of b and c are  degrees C</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> b= 17.502; <span class="keyword">const</span> <span class="keywordtype">double</span> c= 240.97;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        VPSlope=(<a class="code" href="classphotomod_1_1_c_gas_exchange.html#a32e40db907f72c57d9ec546dee8fa75d" title="Saturated vapor pressure at given temperature. ">Es</a>(Temperature)*(b*c)/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#aaaf6c1a776c7562827048da056b07d97" title="Squares number. ">Square</a>(c+Temperature)/<a class="code" href="classphotomod_1_1_c_gas_exchange.html#ab1c65b0756348471b5a5883ec284dbda" title="Air pressure (kPa) ">Press</a>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">return</span> VPSlope; </div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaaf6c1a776c7562827048da056b07d97"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Square </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Squares number. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00227">227</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a34baf0802902fdfcb2d1ed4de13fb2eb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::AssimilationGross</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gross photosynthesis (umol CO2 m-2 s-1) (Adjusted for respiration) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a865730e6305b7c2d58bff95dee109efc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::AssimilationNet</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Net photosynthesis (umol CO2 m-2 s-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a00d3909dbee9dd67c604e2eed4865734"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::BoundaryLayerConductance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boundary layer conductance umol m-2 s-1. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab33ec7e3bbc0ace7cf04efbd46ac68b7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Ci</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal CO2 concentration umol mol-1. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3fc26a2af41fa283a18c5d237a15a971"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Ci_Ca</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ratio of internal to external CO2, unitless. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa69249f07aa4e7350dfdc8bc068f9ac2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::CO2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CO2 concentration (umol mol-1 air) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00195">195</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7b4071e10afdbc6879d155dc141ef379"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool photomod::CGasExchange::ConstantLeafTemperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>if true, uses constant temperature - if true, does not solve for leaf temperature */ </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00223">223</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7b528f4b530d8f3307c17739c7ee62a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::DarkRespiration</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Plant respiration umol m-2 s-1. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a77de70f2ad2c944a44d09574098544ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::eqlTolerance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Equality tolerance. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00217">217</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1b544258c3eed5fa061e40fa3c742d0f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::errTolerance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Error tolerance for iterations. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00216">216</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a62fb21b7ee1c9a4f346a3fa0eb310acb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool photomod::CGasExchange::isCiConverged</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if Ci (internal CO2 concentration) iterations have converged. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00226">226</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4197e7648d565006d6ef69348370e357"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int photomod::CGasExchange::iter1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00224">224</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a194faf8c006a5c21e6d25eb45a73760c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int photomod::CGasExchange::iter2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Iteration counters. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00224">224</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="acac945e291c67bc3a39e5a8cc3b2e147"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int photomod::CGasExchange::iter_Ci</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Iteration value for Ci umol mol-1, internal CO2 concentration. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00225">225</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="ace0a89f55ea363701ca964af605b9944"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int photomod::CGasExchange::iter_total</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of iterations. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00219">219</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="aabd821405fe6b92ccdacbeeaa582198b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::PhotoFluxDensity</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Photosynthetic Flux Density (umol photons m-2 s-1. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00195">195</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0b4eee1a920250217a4f9468788ffd53"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">* std::string photomod::CGasExchange::PlantType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For C3 or C4 designation */. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PlantType</td><td>string that holds the type of plant, C3 or C4 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00222">222</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab1c65b0756348471b5a5883ec284dbda"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Press</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Air pressure (kPa) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00195">195</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="acaf96c972db93276390570b52e2f4efa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::R_abs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Absorbed incident radiation (watts m-2) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00195">195</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a58f7d4d251727e692ac8fbad2fb57956"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::RH</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Relative Humidity (%, i.e., 80) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00195">195</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae2941a2ddaff5c03c5d5ef97f9ffabb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html">photomod::CGasExchange::tParms</a> photomod::CGasExchange::sParms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variable of type <a class="el" href="structphotomod_1_1_c_gas_exchange_1_1t_parms.html" title="parameter description ">tParms</a>. </p>

</div>
</div>
<a class="anchor" id="a50c7b57af404866a64d13704966d1d73"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::StomatalConductance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stomatal conductance umol m-2 s-1. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="acd3e1c02f9ce0d34ea3795046bfec332"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Tair</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Air temperature at 2m, (C) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00195">195</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="aff0c48ce7b3ab2b984bd451cc9af579d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Tleaf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Leaf temperature C. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8989059dc3203e1def79220d27519b04"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::Transpiration</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transpiration mol H2O m-2 s-1. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a66f16f80971e5c5eede33113b0332d7a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::VPD</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vapor Pressure Density, kPa */. </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00205">205</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0196427149bf76a9d50e51bf46392dd7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::width</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Leaf width (m) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00195">195</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae45cf7c89cde073d1aa2eece25727388"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double photomod::CGasExchange::wind</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Windspeed at 2 meters (km s-1) </p>

<p>Definition at line <a class="el" href="gas__exchange_8h_source.html#l00195">195</a> of file <a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="gas__exchange_8h_source.html">gas_exchange.h</a></li>
<li><a class="el" href="gas__exchange_8cpp_source.html">gas_exchange.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jul 15 2016 13:58:59 for A Biochemical Simulation Model of Photosynthesis and Transpiration by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
